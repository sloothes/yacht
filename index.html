<!DOCTYPE html>
<html lang="en">
	<head>

		<title>Dream Yatch (alpha)</title>

		<meta charset="utf-8">
		<meta name="generator" content="Three.js Editor">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

		<link rel="stylesheet" href="/css/joystick.css">
		<link rel="stylesheet" href="/css/bootstrap.min.css">
		<link rel="stylesheet" href="/css/bootbox-dialoges.css">
		<link rel="stylesheet" href="/css/jcrop.css">

		<script src="/js/watch.js"></script>
		<script src="/js/Objectid.js"></script>
		<script src="/js/jquery.min.js"></script> 
		<script src="/js/system.min.js"></script>
		<script src="/js/signals.min.js"></script>
		<script src="/js/inflate.min.js"></script>
		<script src="/js/zangodb.min.js"></script>
		<script src="/js/bootstrap.min.js"></script>
		<script src="/js/hold-event.min.js"></script>
		<script src="/js/jcrop.js"></script>

		<style>

			body {
				margin: 0px;
				font-size: 13px;
				font-family: sans-serif;
				background-repeat: repeat;
				background-image: url("https://i.imgur.com/rnZZU0i.png") !important;
				overflow: hidden;
			}

			#loading-bar {
				width:100%;
				height:100%;
				top:0; left:0;
				position:fixed;
				display:flex;
				align-items:center;
				justify-content:center;
			}

			.middle > * {
				top:0; 
				left:0;
				right:0;
				bottom:0;
				margin:auto;
				position:absolute;
			}

			#joystick1 {
				right: calc(40px + 370px);
			}
			
			#jumpButton {
				right: calc(105px + 370px);
			}

			.btn-matcap,
			.btn-terrain {
				padding:0;
				float:left;
				width:55px;
				height:55px;
				border:1px solid;
				border-radius:4px;
				margin-right:4px;
				margin-bottom:4px;
				display:inline-block;
			}

			.btn-matcap + .btn-matcap,
			.btn-terrain + .btn-terrain {
				margin-right:4px;
			}

		</style>
	</head>

	<body ontouchstart="">

		<script src="/ecs/js/TabUI.js"></script>
		<script>
			const debugMode = true;
			const Signal = signals.Signal;
			document.body.appendChild( createSidePanel() );
		</script>

		<script src="/ecs/js/three.js"></script>
		<script src="/ecs/js/MeshWalk.js"></script>
		<script src="/ecs/js/UVsDebug.js"></script>
		<script src="/ecs/js/FBXLoader.js"></script>
		<script src="/ecs/js/VirtualInput.js"></script>
		<script src="/ecs/js/KeyboardState.js"></script>
		<script src="/ecs/js/EditorControls.js"></script>
		<script src="/ecs/js/camera-controls.js"></script>
		<script src="/ecs/js/SubdivisionModifier.js"></script>
		<script src="/ecs/js/three-pathfinding.umd.js"></script>
		<script src="/threejs/r96/examples/js/loaders/GLTFLoader.js"></script>
		<script src="/threejs/r96/examples/js/exporters/GLTFExporter.js"></script>
		<script src="/threejs/r96/examples/js/exporters/STLExporter.js"></script>
		<script src="/threejs/r96/examples/js/exporters/OBJExporter.js"></script>
		<script src="/threejs/r96/examples/js/exporters/ColladaExporter.js"></script>

		<script src="/three/Ocean_fft.js"></script>
		<script src="/three/MirrorRenderer.js"></script>
		<script src="/three/WaterMaterial.js"></script>
		<script src="/ecs/engine/core/helpers.js"></script>
		<script src="/ecs/engine/core/keyboard.js"></script>
		<script src="/ecs/engine/core/enviroment.js"></script>
		<script src="/ecs/engine/core/localPlayer.js"></script>
		<script src="/ecs/engine/core/cameraControls.js"></script>
		<script src="/ecs/engine/core/keyboardState.js"></script>
		<script src="/ecs/engine/core/keyInputControls.js"></script>
		<script src="/ecs/engine/core/joystickControls.js"></script>
		<script src="/ecs/engine/core/EntityManager.js"></script>
		<script src="/ecs/engine/editor/helpers.js"></script>
		<script src="/ecs/engine/editor/UndoArray.js"></script>

		<script>

			localPlayer.controller.movementSpeed = 45;
			groundHelper.visible = !groundHelper.visible;
		//	TabUI.Editor.role.classList.add("active");
		//	TabUI.Editor.tab.classList.add("in","active");

		</script>

		<script>

		//	Background.

			(function(scene){

				if (!scene || Number(THREE.REVISION) < 78) return;

				var urls = [
					"https://i.imgur.com/v6bjQLb.jpg", // "posx.jpg",
					"https://i.imgur.com/lwrlr6P.jpg", // "negx.jpg", 
					"https://i.imgur.com/kKUKBJg.jpg", // "posy.jpg", 
					"https://i.imgur.com/N0oZlJR.jpg", // "negy.jpg", 
					"https://i.imgur.com/x9q8z0K.jpg", // "posz.jpg", 
					"https://i.imgur.com/HYcK7Ii.jpg", // "negz.jpg"
				];

				var loader = new THREE.CubeTextureLoader();
				loader.setCrossOrigin( "anonymous" );
				loader.load( urls, function(texture){
					scene.background = texture;
					scene.background.needsUpdate = true;
				});

			})(scene);

		</script>

		<script>

		//  Skydome.

			const skydome = (function(scene){
				var loader = new THREE.TextureLoader();
				loader.setCrossOrigin( "anonymous" );
				var geometry = new THREE.SphereGeometry( 2000, 64, 32 );
				var texture = loader.load( "https://i.imgur.com/xQsNP0X.jpg" );
				var material = new THREE.MeshBasicMaterial({map:texture, side:2});
				var dome = new THREE.Mesh( geometry, material );
				dome.scale.y = 0.5;
				dome.name = "SKYDOME";
				scene.add(dome);
				return dome;
			})(scene);

		</script>

		<script>

		//  Water.

			const water = (function(renderer,camera,scene,light){

				var waterNormals = loadTexture("/tradecenter/textures/waternormals.jpg");
				waterNormals.wrapS = waterNormals.wrapT = THREE.RepeatWrapping;

			//  the water effect.
				return new THREE.Water(renderer, camera, scene, {
					textureWidth:256,  textureHeight:256,
					waterNormals:waterNormals, alpha:0.9,
					sunDirection:light.position.normalize(),
					sunColor:0xffffff,  waterColor:0x001e0f,
					betaVersion:0, side:2,
				});

				function loadTexture( url, mapping) {
					var loader = new THREE.TextureLoader();
					loader.setCrossOrigin( "anonymous" );
					var texture = loader.load( url );
					if ( mapping ) texture.mapping = mapping;
					return texture;
				}

			})( renderer,camera,scene,cameraLight );

			(function( scene,water ){
				var material = water.material;
				var geometry = new THREE.PlaneBufferGeometry(100000, 100000, 1000, 1000);
				var mirror = new THREE.Mesh( geometry, material );
				mirror.add(water);
				mirror.rotation.x = - Math.PI * 0.5;
				mirror.position.y = -0.01;
				scene.add(mirror);

				var clock = new THREE.Clock();
				(function render(){
					var dt = clock.getDelta();
					requestFrameID = requestAnimationFrame( render );
					water.material.uniforms.time.value += Math.max(dt, 1/60);
					water.render();
				})();

			})( scene, water );

		</script>

		<script>




























		</script>

	</body>
</html>
